(function(){(function(){(function(){const y="https://www.ebay.com.au/sch/i.html?_nkw=[QUERY]&_pgn=[PAGE]&_sop=12",l={container:"ul.srp-results > li.s-item",title:".s-item__title",price:".s-item__price",link:"a.s-item__link",sponsored_marker:'span[role="text"]',pagination_next:"a.pagination__next",rating:'.x-star-rating .clipped, .b-starrating__star .clipped, [aria-label*="out of 5 stars"]'},N=["#isCartBtn_btn","#atcRedesignId_btn",".x-atc-action .btn"],k=['button[data-testid="cta-add-to-cart"]',".x-atc-action button",'button.ux-call-to-action[aria-label*="Add to cart"]','button.ux-call-to-action[aria-label*="Add to Cart"]',".s-item__addToCart button"],_="select[id^='msku-sel']";function $(o){if(!o)return null;const n=o.replace(/[^0-9.,-]/g,"").replace(/,/g,""),t=parseFloat(n);return Number.isFinite(t)?t:null}function w(){console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ” [EBAY] PRODUCT DETECTION STARTED"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");const o=[];console.log(`ğŸ“ Using selector: "${l.container}"`);const n=document.querySelectorAll(l.container);console.log(`âœ“ Found ${n.length} product containers
`);let t=0;return n.forEach((e,c)=>{var h;if(console.group(`ğŸ›ï¸  Product #${c+1}`),!m(e)){console.log("âŒ SKIPPED - Not visible"),console.groupEnd();return}const f=e.querySelector(l.sponsored_marker);if(f?/(sponsored|promoted)/i.test(f.textContent||""):!1){console.log("âŒ SKIPPED - Sponsored product"),console.groupEnd();return}console.log(`ğŸ“ Title selector: "${l.title}"`);const p=e.querySelector(l.title),s=p?(p.textContent||"").trim():null;console.log(`ğŸ“ Title found: "${s}"`),console.log(`ğŸ“ Title length: ${(s==null?void 0:s.length)||0} characters`),console.log(`ğŸ“ Price selector: "${l.price}"`);const T=e.querySelector(l.price),a=T?(T.textContent||"").trim():null;console.log(`ğŸ’µ Price text: "${a}"`);const E=$(a||void 0);console.log(`ğŸ’° Price parsed: ${E}`),console.log(`ğŸ“ Rating selector: "${l.rating}"`);const d=e.querySelector(l.rating);let u=null;if(d){const r=(d.getAttribute("aria-label")||"").match(/([\d.]+)\s*(?:out of|\/)\s*5/i)||((h=d.textContent)==null?void 0:h.match(/([\d.]+)/));r&&(u=parseFloat(r[1]))}console.log(`â­ Rating parsed: ${u}`),console.log(`ğŸ“ Link selector: "${l.link}"`);const b=e.querySelector(l.link),S=b?b.href:null;console.log(`ğŸ”— Link: ${S}`);let g=null;for(const C of k){const r=e.querySelector(C);if(r&&m(r)){g=A(r),console.log(`ğŸ›’ Add-to-cart button found: ${g}`);break}}o.push({selector:A(e)||void 0,title:s,price:a||null,priceNumber:E,rating:u,availability:null,link:S,isDetailPage:!1,addToCartSelector:g}),console.log("âœ… ADDED to results"),console.groupEnd(),console.log(""),t++,t>=5}),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ“¦ EXTRACTION COMPLETE"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log(`ğŸ“Š Total containers found: ${n.length}`),console.log(`âœ“ Valid products extracted: ${o.length}`),console.log(`
ğŸ“‹ PRODUCTS BEING SENT TO LLM (FULL TITLES - NOT TRUNCATED):
`),o.forEach((e,c)=>{console.log(`
ğŸ›ï¸  PRODUCT ${c+1}:`),console.log(`   ğŸ“ Title:   ${e.title}`),console.log(`   ğŸ’° Price:   ${e.price}`),console.log(`   â­ Rating:  ${e.rating||"N/A"}`),console.log(`   ğŸ”— Link:    ${e.link}`)}),console.log(`
ğŸ“Š SUMMARY TABLE:`),console.table(o.map(e=>({"Title (Full)":e.title,Price:e.price,Rating:e.rating||"N/A"}))),console.log(`
ğŸ“„ FULL JSON DATA (for LLM):`),console.log(JSON.stringify(o,null,2)),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`),o.slice(0,5)}async function R(o){console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ›’ [EBAY] EXECUTING: ADD TO CART"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ“‹ Arguments received:"),console.log(JSON.stringify(o,null,2)),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);try{if(P())return console.log("âš ï¸  CAPTCHA detected - aborting action"),{success:!1,error:"CAPTCHA detected - pausing actions",data:{captcha:!0}};if(o.addToCartSelector){console.log(`ğŸ” Trying pre-detected ATC selector: ${o.addToCartSelector}`);const t=document.querySelector(o.addToCartSelector);if(t&&!t.disabled)return console.log("âœ“ Button found and enabled - clicking"),t.click(),await i(400+Math.random()*600),console.log(`âœ… Success: Clicked pre-detected SRP button
`),{success:!0,data:{clicked:"srp_predetected"}};console.log("âŒ Button not found or disabled")}if(o.selector){console.log(`ğŸ” Trying product card selector: ${o.selector}`);const t=document.querySelector(o.selector);if(t){console.log("âœ“ Product card found");for(const e of k){console.log(`  ğŸ” Trying ATC selector: ${e}`);const c=t.querySelector(e);if(c&&!c.disabled)return console.log("  âœ“ Button found and enabled - clicking"),c.click(),await i(400+Math.random()*600),console.log(`âœ… Success: Clicked SRP card button
`),{success:!0,data:{clicked:"srp_card"}}}console.log("âŒ No enabled ATC button found in card")}else console.log("âŒ Product card not found")}if(o.link)return console.log(`ğŸ”— Navigating to product page: ${o.link}`),window.location.href=o.link,console.log(`âœ… Success: Navigation initiated
`),{success:!0,data:{navigatedToPDP:!0,url:o.link}};if(o.productId){console.log(`ğŸ” Trying to find product by ID: ${o.productId}`);const t=document.querySelector(`[data-id='${o.productId}'], a[href*='/${o.productId}']`);if(t){const e=t.closest("a");if(e!=null&&e.href)return console.log(`âœ“ Product link found: ${e.href}`),window.location.href=e.href,console.log(`âœ… Success: Navigation initiated
`),{success:!0,data:{navigatedToPDP:!0,url:e.href}}}console.log("âŒ Product link not found")}console.log("ğŸ” Checking for variant selectors");const n=document.querySelector(_);n&&n.options.length>1&&(console.log("âœ“ Variant selector found - selecting first option"),n.selectedIndex=1,n.dispatchEvent(new Event("change",{bubbles:!0})),await i(500+Math.random()*400)),console.log("ğŸ” Trying standard ATC selectors");for(const t of N){console.log(`  ğŸ” Trying: ${t}`);const e=document.querySelector(t);if(e&&!e.disabled)return console.log("  âœ“ Button found and enabled - clicking"),e.click(),await i(500+Math.random()*600),console.log(`âœ… Success: Clicked button with selector ${t}
`),{success:!0,data:{clicked:t}}}return console.log("âŒ No enabled buttons found with standard selectors"),console.log(`âŒ FAILED: Add to cart button not found or disabled
`),{success:!1,error:"Add to cart button not found or disabled"}}catch(n){return console.error("âŒ ERROR:",n),{success:!1,error:String(n)}}}function P(){return window.location.href.toLowerCase().includes("captcha")||/verify/i.test(document.body.textContent||"")?!0:document.querySelectorAll('form[action*="captcha"], div[class*="captcha"], iframe[src*="captcha"]').length>0}function m(o){try{const n=o.getBoundingClientRect();return n.width>0&&n.height>0}catch{return!1}}function A(o){if(!(o instanceof Element))return null;if(o.id)return`#${o.id}`;const n=[];let t=o;for(;t&&t.nodeType===Node.ELEMENT_NODE&&t!==document.documentElement;){let e=t.nodeName.toLowerCase();if(t.className){const c=t.className.split(" ")[0];c&&(e+=`.${c}`)}n.unshift(e),t=t.parentElement}return n.length?n.join(" > "):null}function i(o){return new Promise(n=>setTimeout(n,o))}function L(o){return console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ”— [EBAY] EXECUTING: NAVIGATE TO PRODUCT"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ“‹ Arguments received:"),console.log(JSON.stringify(o,null,2)),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`),o.link?(console.log(`ğŸ”— Navigating to: ${o.link}`),window.location.href=o.link,console.log(`âœ… Success: Navigation initiated
`),{success:!0,data:{navigatedToPDP:!0,url:o.link}}):(console.log(`âŒ FAILED: No link URL provided
`),{success:!1,error:"No link URL provided"})}window.__siteIntegration=window.__siteIntegration||{};window.__siteIntegration.ebay={detectProductCards:w,addToCart:R,navigateToProduct:L,detectCaptcha:P,SEARCH_TEMPLATE:y,SELECTORS:l};window.__siteIntegrationReady=!0;console.debug("eBay AU site integration injected and ready");
})()
})()
})()
