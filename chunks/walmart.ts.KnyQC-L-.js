(function(){(function(){(function(){const A="https://www.walmart.com/search?q=[QUERY]",m={grid_container:"section > div",item_card:"section > div > div",title:"div.sans-serif.mid-gray.relative.flex.flex-column.w-100.hide-child-opacity > a > span > h3",price:"div.sans-serif.mid-gray.relative.flex.flex-column.w-100.hide-child-opacity > div > div:nth-child(3) > div.mt1 > div > span",link:"div.sans-serif.mid-gray.relative.flex.flex-column.w-100.hide-child-opacity > a",sponsored:"div",rating:"div.sans-serif.mid-gray.relative.flex.flex-column.w-100.hide-child-opacity > div > div:nth-child(3) > div.flex.items-center.mv1 > span.w_iUH7",add_to_cart_in_card:"div.sans-serif.mid-gray.relative.flex.flex-column.w-100.hide-child-opacity > div > div.z-2.relative.mv2 > div > div > button",cart_button:"#cart-button-header",search_bar:"#__next > div.flex.flex-column.min-vh-100.shadow-2 > span > header > form > div > input"};m.add_to_cart_in_card;const _=[m.add_to_cart_in_card,"button[data-automation-id='add-to-cart']","button[data-tl-id*='cta-add-to-cart']","button[aria-label*='Add to cart']","button[aria-label*='Add to Cart']",".add-to-cart-button"],E="[data-testid='variant-group']",P="button[data-tl-id*='cta-add-to-cart']";function x(t){if(!t)return null;const l=t.replace(/[^0-9.,-]/g,"").replace(/,/g,""),e=parseFloat(l);return Number.isFinite(e)?e:null}function R(){var l;console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ” [WALMART] PRODUCT DETECTION STARTED (STRICT USER MODE - V2)"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");const t=[];for(let e=1;e<=12;e++){console.group(`ğŸ›ï¸  Product #${e}`);const i=`section > div > div:nth-child(${e})`,o=document.querySelector(i);if(!o){console.log(`âŒ Grid item not found: ${i}`),console.groupEnd();continue}let n=o.querySelector("a > span > h3");n||(n=o.querySelector("h3"));const a=n?(n.textContent||"").trim():null;if(console.log(`ğŸ“ Title: "${a}"`),!a){console.log("âŒ No title found"),console.groupEnd();continue}let c=o.querySelector("div.sans-serif.mid-gray.relative.flex.flex-column.w-100.hide-child-opacity");!c&&n&&(c=n.closest('div[class*="flex-column"]')||o);let h=c==null?void 0:c.querySelector("div > div:nth-child(2) > div:nth-child(2) > div > span");if(!h){const s=o.querySelectorAll("span");for(const g of s){const f=g.textContent||"";if(f.includes("$")||f.toLowerCase().includes("current price")){h=g;break}}}let v=h?(h.textContent||"").trim():null,r=null;if(v){const s=v.match(/\$?\d+(?:,\d{3})*(?:\.\d+)?/);s?(r=s[0],r.startsWith("$")||(r="$"+r)):r=v}console.log(`ğŸ’µ Price: "${r}"`);const w=x(r||void 0);let u=c==null?void 0:c.querySelector("div > div:nth-child(2) > div.flex.items-center.mv1 > span.w_iUH7");u||(u=o.querySelector('[aria-label*="rating"], .w_iUH7'));let T=null;if(u){const s=u.getAttribute("aria-label"),g=(l=u.textContent)==null?void 0:l.trim(),f=(s||g||"").match(/([\d.]+)\s*(?:out of|\/)\s*5/i);if(f)T=parseFloat(f[1]);else{const S=(s||g||"").match(/^([\d.]+)$/);if(S){const y=parseFloat(S[1]);y<=5&&(T=y)}}}let p=c==null?void 0:c.querySelector("a");p||(p=o.querySelector('a[href*="/ip/"]'));const b=p?p.href:null;console.log(`ğŸ”— Link: ${b}`),t.push({selector:i,title:a,price:r||null,priceNumber:w,rating:T,availability:null,link:b,isDetailPage:!1,addToCartSelector:null,productIndex:e}),console.log("âœ… ADDED"),console.groupEnd()}return console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ“¦ EXTRACTION COMPLETE"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log(`âœ“ Valid products extracted: ${t.length}`),console.log(`
ğŸ“‹ PRODUCTS BEING SENT TO LLM (FULL TITLES - NOT TRUNCATED):
`),t.forEach((e,i)=>{console.log(`
ğŸ›ï¸  PRODUCT ${i+1}:`),console.log(`   ğŸ“ Title:   ${e.title}`),console.log(`   ğŸ’° Price:   ${e.price}`),console.log(`   â­ Rating:  ${e.rating||"N/A"}`),console.log(`   ğŸ”— Link:    ${e.link}`)}),console.log(`
ğŸ“Š SUMMARY TABLE:`),console.table(t.map(e=>({"Title (Full)":e.title,Price:e.price,Rating:e.rating||"N/A"}))),console.log(`
ğŸ“„ FULL JSON DATA (for LLM):`),console.log(JSON.stringify(t,null,2)),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`),t.slice(0,5)}async function k(t){console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ›’ [WALMART] EXECUTING: ADD TO CART"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ“‹ Arguments received:"),console.log(JSON.stringify(t,null,2)),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);try{if(C())return console.log("âš ï¸  CAPTCHA detected - aborting action"),{success:!1,error:"CAPTCHA detected - pausing actions",data:{captcha:!0}};if(t.addToCartSelector){console.log(`ğŸ” Trying pre-detected ATC selector: ${t.addToCartSelector}`);const o=document.querySelector(t.addToCartSelector);if(o&&!o.disabled)return console.log("âœ“ Button found and enabled - clicking"),o.click(),await d(400+Math.random()*600),console.log(`âœ… Success: Clicked pre-detected SRP button
`),{success:!0,data:{clicked:"srp_predetected"}};console.log("âŒ Button not found or disabled")}if(t.selector){console.log(`ğŸ” Trying product card selector: ${t.selector}`);const o=document.querySelector(t.selector);if(o){console.log("âœ“ Product card found");for(const n of _){console.log(`  ğŸ” Trying ATC selector: ${n}`);const a=o.querySelector(n);if(a&&!a.disabled)return console.log("  âœ“ Button found and enabled - clicking"),a.click(),await d(400+Math.random()*800),console.log(`âœ… Success: Clicked SRP card button
`),{success:!0,data:{clicked:"srp_card"}}}console.log("âŒ No enabled ATC button found in card")}else console.log("âŒ Product card not found")}if(t.link)return console.log(`ğŸ”— Navigating to product page: ${t.link}`),window.location.href=t.link,console.log(`âœ… Success: Navigation initiated
`),{success:!0,data:{navigatedToPDP:!0,url:t.link}};console.log("ğŸ” Trying PDP add-to-cart button");const l=document.querySelector(P);if(l&&!l.disabled){console.log("âœ“ PDP add button found");const o=document.querySelector(E);if(o){console.log("âœ“ Variant group found - selecting first option");const n=o.querySelector("select option:nth-child(2)");n&&(n.selected=!0,n.dispatchEvent(new Event("change",{bubbles:!0})),await d(400+Math.random()*400))}return console.log("âœ“ Clicking PDP add button"),l.click(),await d(500+Math.random()*700),console.log(`âœ… Success: Clicked PDP add button
`),{success:!0,data:{clicked:"pdp_add"}}}console.log("âŒ PDP button not found or disabled"),console.log("ğŸ” Trying text-based button search");const i=Array.from(document.querySelectorAll('button, input[type="submit"], a')).find(o=>{const n=(o.textContent||o.value||"").toLowerCase().trim();return(n==="add to cart"||n==="add to basket")&&!o.disabled});return i?(console.log(`âœ“ Found button with text: "${i.textContent}"`),i.click(),await d(500+Math.random()*700),console.log(`âœ… Success: Clicked text-matched button
`),{success:!0,data:{clicked:"text_match",text:i.textContent}}):(console.log(`âŒ FAILED: No add-to-cart button found
`),{success:!1,error:"No add-to-cart button found"})}catch(l){return console.error("âŒ ERROR:",l),{success:!1,error:String(l)}}}function C(){return window.location.href.toLowerCase().includes("captcha")||/verify you are a human/i.test(document.body.textContent||"")?!0:document.querySelectorAll('iframe[src*="recaptcha"], div[class*="captcha"]').length>0}function d(t){return new Promise(l=>setTimeout(l,t))}function N(t){return console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ”— [WALMART] EXECUTING: NAVIGATE TO PRODUCT"),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ“‹ Arguments received:"),console.log(JSON.stringify(t,null,2)),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`),t.link?(console.log(`ğŸ”— Navigating to: ${t.link}`),window.location.href=t.link,console.log(`âœ… Success: Navigation initiated
`),{success:!0,data:{navigatedToPDP:!0,url:t.link}}):(console.log(`âŒ FAILED: No link URL provided
`),{success:!1,error:"No link URL provided"})}async function L(){console.log(`
`),console.log("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"),console.log("ğŸ›’ [WALMART] EXECUTING: OPEN CART"),console.log(`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);try{const t=document.querySelector(m.cart_button);return t?(console.log("âœ“ Cart button found, clicking..."),t.click(),await d(500),console.log(`âœ… Success: Cart opened
`),{success:!0,data:{clicked:"cart_button"}}):(console.log("âš ï¸ Cart button not found, navigating to cart URL..."),window.location.href="https://www.walmart.com/cart",{success:!0,data:{navigated:"cart_url"}})}catch(t){return console.error("âŒ ERROR:",t),{success:!1,error:String(t)}}}window.__siteIntegration=window.__siteIntegration||{};window.__siteIntegration.walmart={detectProductCards:R,addToCart:k,navigateToProduct:N,openCart:L,detectCaptcha:C,SEARCH_URL:A,SELECTORS:m};window.__siteIntegrationReady=!0;console.debug("Walmart site integration injected and ready");
})()
})()
})()
