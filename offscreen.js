import"./chunks/modulepreload-polyfill.B5Qt9EMX.js";let i=null,n=!1;chrome.runtime.onMessage.addListener((o,r,e)=>{o.type==="START_RECORDING"?(a(),e({success:!0})):o.type==="STOP_RECORDING"&&(l(),e({success:!0}))});function a(){if(!n)if("webkitSpeechRecognition"in window)try{const o=window.SpeechRecognition||window.webkitSpeechRecognition,r=new o;i=r,r.continuous=!0,r.interimResults=!0,r.lang="en-US",r.onstart=()=>{n=!0,chrome.runtime.sendMessage({type:"RECORDING_STARTED"})},r.onresult=e=>{let t="",c="";for(let s=e.resultIndex;s<e.results.length;++s)e.results[s].isFinal?t+=e.results[s][0].transcript:c+=e.results[s][0].transcript;chrome.runtime.sendMessage({type:"TRANSCRIPT",payload:{final:t,interim:c}})},r.onerror=e=>{console.error("Speech recognition error",e.error);const t=e.error==="not-allowed"?"Microphone permission denied. Chrome extensions need microphone access. Please check chrome://settings/content/microphone":e.error==="no-speech"?"No speech detected. Please try speaking again.":`Speech error: ${e.error}`;chrome.runtime.sendMessage({type:"RECORDING_ERROR",payload:{error:t}}),n=!1},r.onend=()=>{n=!1,chrome.runtime.sendMessage({type:"RECORDING_STOPPED"})},r.start()}catch(o){console.error("Failed to start recognition",o),chrome.runtime.sendMessage({type:"RECORDING_ERROR",payload:{error:o.message}})}else chrome.runtime.sendMessage({type:"RECORDING_ERROR",payload:{error:"Speech recognition not supported in this browser"}})}function l(){i&&(i.stop(),i=null,n=!1)}
